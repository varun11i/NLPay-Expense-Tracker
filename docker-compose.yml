services:
  gullak:
    image: ghcr.io/mr-karan/gullak:latest
    container_name: gullak
    restart: unless-stopped
    ports:
      - "3333:3333"
    volumes:
      # Persist the SQLite database
      - ./data:/app/data
      - ./config.toml:/app/config.toml:ro 
    environment:
      - TZ=America/New_York
      - GULLAK_APP_DB_PATH=/app/data/expenses.db
      - GULLAK_APP_CURRENCY=USD
      - GULLAK_APP_DEBUG=false

      # Use Groq via OpenAI-compatible API
      - GULLAK_OPENAI_BASE_URL=https://api.groq.com/openai/v1
      - GULLAK_OPENAI_MODEL=llama-3.1-8b-instant
      - GULLAK_OPENAI_TOKEN=${GROQ_TOKEN}

      - GULLAK_HTTP_ADDRESS=:3333
      - GULLAK_HTTP_TIMEOUT=30s
      - GULLAK_OPENAI_TIMEOUT=10s 

    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:3333"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
